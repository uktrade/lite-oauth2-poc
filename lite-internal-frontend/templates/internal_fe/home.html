{% block content %}
<h1>Internal User Home</h1>

{% if is_authenticated %}
    You are logged in locally
    <p>
        <a href="{% url 'auth:logout' %}?next={{ request.path }}">Logout</a>
    </p>

    <h3>User Profile</h3>
    <pre>{{ profile }}</pre>
    <h3>Remote API response</h3>
    <form method="post">
        {% csrf_token %}
        {% if api_response.status_code == 200 %}
            {{ api_response.json }}
            <button name="action" type="submit" value="delete">Delete</button>
        {% elif api_response.status_code == 401 %}
            You don't have a user on remote server. 
            {% if request.session.jwt %}
                <button name="action" type="submit" value="create">Create one now via OIDC</button>
            {% else %}
                <a href="{% url 'auth:logout' %}?next=/">Logout and restart Oauth2 flow</a>
            {% endif %}
        {% else %}
            <p>{{ api_response.status_code }} {{ api_response }}</p>
        {% endif %}
    </form>

{% else %}
    You're not logged in locally. 
    <p>
        <a href="{% url 'auth:login' %}?user_type=internal">Login using Oauth2</a>
    </p>
    <p>
        <a href="{% url 'auth:jwt-login' %}">Login using OIDC</a>
    </p>
{% endif %}

{% endblock %}
